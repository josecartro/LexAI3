========================================
CUSTOM JINJA TEMPLATE FOR LM STUDIO
Paste ONLY lines 6-42 into LM Studio
========================================

{{- bos_token }}
{%- if messages[0]['role'] == 'system' %}
<|im_start|>system
{{ messages[0]['content'] }}
{%- if tools %}

# Available Tools
You can call these tools to get real data. Output tool calls in XML format when you need factual information:

{% for tool in tools -%}
- {{ tool.function.name }}: {{ tool.function.description }}
{% endfor %}

To call a tool, output:
<tool_call>
<name>tool_name</name>
<arguments>{"param": "value"}</arguments>
</tool_call>

When you have enough data or for simple queries, respond normally without tool tags.
{%- endif %}
<|im_end|>
{%- set start_idx = 1 %}
{%- else %}
{%- set start_idx = 0 %}
{% endif %}
{%- for message in messages[start_idx:] %}
{%- if message.role == 'user' %}
<|im_start|>user
{{ message.content }}<|im_end|>
{%- elif message.role == 'assistant' %}
<|im_start|>assistant
{{ message.content }}<|im_end|>
{%- elif message.role == 'tool' %}
<|im_start|>tool
{{ message.content }}<|im_end|>
{%- endif %}
{%- endfor %}
<|im_start|>assistant
